<ion-header>
  <ion-toolbar class="editor-header">
    <ion-buttons slot="start">
      <!-- now calls closeEditor() -->
      <ion-button fill="clear" (click)="closeEditor()">
        <ion-icon name="chevron-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title></ion-title>
    <ion-buttons slot="end">
      <ion-button fill="solid" color="primary" class="next-circle" (click)="exportVideo()">
        <ion-icon name="arrow-forward-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="editor-content">
  <!-- VIDEO PREVIEW -->
  <div class="video-wrapper">
    <video #videoPlayer [src]="videoSrc" playsinline></video>
    <!-- Template image preview in the same position -->
    <div
      class="template-video-preview"
      *ngIf="selectedTemplateImage"
      [style.top.px]="templateImagePosition.top"
      [style.left.px]="templateImagePosition.left"
    >
      <img [src]="selectedTemplateImage" alt="Template Preview" />
    </div>
  </div>

  <!-- TIMELINE WITH TRIMMING HANDLES -->
  <div class="timeline-container">
    <div class="timeline">
      <!-- Placeholder thumbnails for the video timeline -->
      <div class="timeline-thumbnails">
        <div class="thumbnail" *ngFor="let i of [1, 2, 3, 4, 5, 6, 7, 8]"></div>
      </div>
      <!-- Trimming handles -->
      <div class="trim-handles">
        <div class="trim-start" (mousedown)="startTrim($event, 'start')"></div>
        <div class="trim-end" (mousedown)="startTrim($event, 'end')"></div>
      </div>
      <!-- Seek bar within the trimmed area -->
      <input
        type="range"
        class="seek-bar"
        [min]="trimStart"
        [max]="trimEnd"
        [step]="0.1"
        [value]="currentTime"
        (input)="seek($event)"
      />
    </div>
  </div>

  <!-- TOOLBAR -->
  <div class="editor-tools">
    <!-- Play/Pause -->
    <ion-button fill="clear" (click)="togglePlay()">
      <ion-icon [name]="isPlaying ? 'pause' : 'play'"></ion-icon>
    </ion-button>

    <!-- Speed control -->
    <ion-button fill="clear" (click)="toggleSpeed()">
      <ion-icon name="speedometer-outline"></ion-icon>
    </ion-button>

    <!-- Mark Start / End -->
    <ion-button fill="clear" (click)="markInOut()">
      <ion-icon name="swap-horizontal-outline"></ion-icon>
    </ion-button>

    <!-- Rotate clip -->
    <ion-button fill="clear" (click)="rotateClip()">
      <ion-icon name="repeat-outline"></ion-icon>
    </ion-button>

    <!-- Mute/unmute -->
    <ion-button fill="clear" (click)="toggleMute()">
      <ion-icon [name]="isMuted ? 'volume-mute-outline' : 'volume-high-outline'"></ion-icon>
    </ion-button>
  </div>
</ion-content>